<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type='text/xsl' href="scriptsql.xsl"?>
<root xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<database includeDrop="true">petshopDB</database>
<procedures>
		
		<procedure owner="dbo" name="Account_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Account table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Account_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Account table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[Id]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [Id]'
				SET @SQL = @SQL + ', [FirstName]'
				SET @SQL = @SQL + ', [LastName]'
				SET @SQL = @SQL + ', [StreetAddress]'
				SET @SQL = @SQL + ', [PostalCode]'
				SET @SQL = @SQL + ', [City]'
				SET @SQL = @SQL + ', [StateOrProvince]'
				SET @SQL = @SQL + ', [Country]'
				SET @SQL = @SQL + ', [TelephoneNumber]'
				SET @SQL = @SQL + ', [Email]'
				SET @SQL = @SQL + ', [Login]'
				SET @SQL = @SQL + ', [Password]'
				SET @SQL = @SQL + ', [IWantMyList]'
				SET @SQL = @SQL + ', [IWantPetTips]'
				SET @SQL = @SQL + ', [FavoriteLanguage]'
				SET @SQL = @SQL + ', [CreditCardId]'
				SET @SQL = @SQL + ', [FavoriteCategoryId]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Account]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [Id],'
				SET @SQL = @SQL + ' [FirstName],'
				SET @SQL = @SQL + ' [LastName],'
				SET @SQL = @SQL + ' [StreetAddress],'
				SET @SQL = @SQL + ' [PostalCode],'
				SET @SQL = @SQL + ' [City],'
				SET @SQL = @SQL + ' [StateOrProvince],'
				SET @SQL = @SQL + ' [Country],'
				SET @SQL = @SQL + ' [TelephoneNumber],'
				SET @SQL = @SQL + ' [Email],'
				SET @SQL = @SQL + ' [Login],'
				SET @SQL = @SQL + ' [Password],'
				SET @SQL = @SQL + ' [IWantMyList],'
				SET @SQL = @SQL + ' [IWantPetTips],'
				SET @SQL = @SQL + ' [FavoriteLanguage],'
				SET @SQL = @SQL + ' [CreditCardId],'
				SET @SQL = @SQL + ' [FavoriteCategoryId],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Account]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Account_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Account table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@FirstName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@LastName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@StreetAddress" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@PostalCode" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@StateOrProvince" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Country" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@TelephoneNumber" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Email" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Login" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Password" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@IWantMyList" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault=""/>
				<parameter name="@IWantPetTips" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault=""/>
				<parameter name="@FavoriteLanguage" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@FavoriteCategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Account]
					(
					[Id]
					,[FirstName]
					,[LastName]
					,[StreetAddress]
					,[PostalCode]
					,[City]
					,[StateOrProvince]
					,[Country]
					,[TelephoneNumber]
					,[Email]
					,[Login]
					,[Password]
					,[IWantMyList]
					,[IWantPetTips]
					,[FavoriteLanguage]
					,[CreditCardId]
					,[FavoriteCategoryId]
					)
				VALUES
					(
					@Id
					,@FirstName
					,@LastName
					,@StreetAddress
					,@PostalCode
					,@City
					,@StateOrProvince
					,@Country
					,@TelephoneNumber
					,@Email
					,@Login
					,@Password
					,@IWantMyList
					,@IWantPetTips
					,@FavoriteLanguage
					,@CreditCardId
					,@FavoriteCategoryId
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Account]
				WHERE
[Id] = @Id 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Account_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Account table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@FirstName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@LastName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@StreetAddress" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@PostalCode" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@StateOrProvince" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Country" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@TelephoneNumber" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Email" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Login" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Password" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@IWantMyList" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault=""/>
				<parameter name="@IWantPetTips" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault=""/>
				<parameter name="@FavoriteLanguage" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@FavoriteCategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Account]
				SET
					[Id] = @Id
					,[FirstName] = @FirstName
					,[LastName] = @LastName
					,[StreetAddress] = @StreetAddress
					,[PostalCode] = @PostalCode
					,[City] = @City
					,[StateOrProvince] = @StateOrProvince
					,[Country] = @Country
					,[TelephoneNumber] = @TelephoneNumber
					,[Email] = @Email
					,[Login] = @Login
					,[Password] = @Password
					,[IWantMyList] = @IWantMyList
					,[IWantPetTips] = @IWantPetTips
					,[FavoriteLanguage] = @FavoriteLanguage
					,[CreditCardId] = @CreditCardId
					,[FavoriteCategoryId] = @FavoriteCategoryId
				WHERE
[Id] = @OriginalId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Account]
				WHERE
[Id] = @Id 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Account_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Account table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Account] WITH (ROWLOCK) 
				WHERE
					[Id] = @Id
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Account_GetByFavoriteCategoryId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Account table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@FavoriteCategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
				WHERE
					[FavoriteCategoryId] = @FavoriteCategoryId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Account_GetByCreditCardId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Account table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
				WHERE
					[CreditCardId] = @CreditCardId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Account_GetById" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Account table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
				WHERE
					[Id] = @Id
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Account_GetByLogin" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Account table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Login" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
				WHERE
					[Login] = @Login
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Account_GetByLastName" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Account table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@LastName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[FirstName],
					[LastName],
					[StreetAddress],
					[PostalCode],
					[City],
					[StateOrProvince],
					[Country],
					[TelephoneNumber],
					[Email],
					[Login],
					[Password],
					[IWantMyList],
					[IWantPetTips],
					[FavoriteLanguage],
					[CreditCardId],
					[FavoriteCategoryId],
					[Timestamp]
				FROM
					dbo.[Account]
				WHERE
					[LastName] = @LastName
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Account_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Account table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@FirstName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@LastName" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@StreetAddress" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@PostalCode" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@City" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@StateOrProvince" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Country" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@TelephoneNumber" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Email" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Login" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Password" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@IWantMyList" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@IWantPetTips" type="bit" direction="Input" size="1" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@FavoriteLanguage" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@FavoriteCategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Id]
	, [FirstName]
	, [LastName]
	, [StreetAddress]
	, [PostalCode]
	, [City]
	, [StateOrProvince]
	, [Country]
	, [TelephoneNumber]
	, [Email]
	, [Login]
	, [Password]
	, [IWantMyList]
	, [IWantPetTips]
	, [FavoriteLanguage]
	, [CreditCardId]
	, [FavoriteCategoryId]
	, [Timestamp]
    FROM
	dbo.[Account]
    WHERE 
	 ([Id] = @Id OR @Id is null)
	AND ([FirstName] = @FirstName OR @FirstName is null)
	AND ([LastName] = @LastName OR @LastName is null)
	AND ([StreetAddress] = @StreetAddress OR @StreetAddress is null)
	AND ([PostalCode] = @PostalCode OR @PostalCode is null)
	AND ([City] = @City OR @City is null)
	AND ([StateOrProvince] = @StateOrProvince OR @StateOrProvince is null)
	AND ([Country] = @Country OR @Country is null)
	AND ([TelephoneNumber] = @TelephoneNumber OR @TelephoneNumber is null)
	AND ([Email] = @Email OR @Email is null)
	AND ([Login] = @Login OR @Login is null)
	AND ([Password] = @Password OR @Password is null)
	AND ([IWantMyList] = @IWantMyList OR @IWantMyList is null)
	AND ([IWantPetTips] = @IWantPetTips OR @IWantPetTips is null)
	AND ([FavoriteLanguage] = @FavoriteLanguage OR @FavoriteLanguage is null)
	AND ([CreditCardId] = @CreditCardId OR @CreditCardId is null)
	AND ([FavoriteCategoryId] = @FavoriteCategoryId OR @FavoriteCategoryId is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Id]
	, [FirstName]
	, [LastName]
	, [StreetAddress]
	, [PostalCode]
	, [City]
	, [StateOrProvince]
	, [Country]
	, [TelephoneNumber]
	, [Email]
	, [Login]
	, [Password]
	, [IWantMyList]
	, [IWantPetTips]
	, [FavoriteLanguage]
	, [CreditCardId]
	, [FavoriteCategoryId]
	, [Timestamp]
    FROM
	dbo.[Account]
    WHERE 
	 ([Id] = @Id AND @Id is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([LastName] = @LastName AND @LastName is not null)
	OR ([StreetAddress] = @StreetAddress AND @StreetAddress is not null)
	OR ([PostalCode] = @PostalCode AND @PostalCode is not null)
	OR ([City] = @City AND @City is not null)
	OR ([StateOrProvince] = @StateOrProvince AND @StateOrProvince is not null)
	OR ([Country] = @Country AND @Country is not null)
	OR ([TelephoneNumber] = @TelephoneNumber AND @TelephoneNumber is not null)
	OR ([Email] = @Email AND @Email is not null)
	OR ([Login] = @Login AND @Login is not null)
	OR ([Password] = @Password AND @Password is not null)
	OR ([IWantMyList] = @IWantMyList AND @IWantMyList is not null)
	OR ([IWantPetTips] = @IWantPetTips AND @IWantPetTips is not null)
	OR ([FavoriteLanguage] = @FavoriteLanguage AND @FavoriteLanguage is not null)
	OR ([CreditCardId] = @CreditCardId AND @CreditCardId is not null)
	OR ([FavoriteCategoryId] = @FavoriteCategoryId AND @FavoriteCategoryId is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Category_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Category table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Name],
					[AdvicePhoto],
					[Timestamp]
				FROM
					dbo.[Category]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Category_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Category table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[Id]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [Id]'
				SET @SQL = @SQL + ', [Name]'
				SET @SQL = @SQL + ', [AdvicePhoto]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Category]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [Id],'
				SET @SQL = @SQL + ' [Name],'
				SET @SQL = @SQL + ' [AdvicePhoto],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Category]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Category_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Category table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@AdvicePhoto" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Category]
					(
					[Id]
					,[Name]
					,[AdvicePhoto]
					)
				VALUES
					(
					@Id
					,@Name
					,@AdvicePhoto
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Category]
				WHERE
[Id] = @Id 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Category_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Category table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@AdvicePhoto" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Category]
				SET
					[Id] = @Id
					,[Name] = @Name
					,[AdvicePhoto] = @AdvicePhoto
				WHERE
[Id] = @OriginalId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Category]
				WHERE
[Id] = @Id 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Category_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Category table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Category] WITH (ROWLOCK) 
				WHERE
					[Id] = @Id
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Category_GetById" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Category table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[Name],
					[AdvicePhoto],
					[Timestamp]
				FROM
					dbo.[Category]
				WHERE
					[Id] = @Id
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Category_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Category table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@AdvicePhoto" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [AdvicePhoto]
	, [Timestamp]
    FROM
	dbo.[Category]
    WHERE 
	 ([Id] = @Id OR @Id is null)
	AND ([Name] = @Name OR @Name is null)
	AND ([AdvicePhoto] = @AdvicePhoto OR @AdvicePhoto is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [AdvicePhoto]
	, [Timestamp]
    FROM
	dbo.[Category]
    WHERE 
	 ([Id] = @Id AND @Id is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([AdvicePhoto] = @AdvicePhoto AND @AdvicePhoto is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Courier_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Courier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[CourierId],
					[CourierName],
					[CourierDescription],
					[MinItems],
					[MaxItems],
					[Timestamp]
				FROM
					dbo.[Courier]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Courier_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Courier table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[CourierId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [CourierId]'
				SET @SQL = @SQL + ', [CourierName]'
				SET @SQL = @SQL + ', [CourierDescription]'
				SET @SQL = @SQL + ', [MinItems]'
				SET @SQL = @SQL + ', [MaxItems]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Courier]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [CourierId],'
				SET @SQL = @SQL + ' [CourierName],'
				SET @SQL = @SQL + ' [CourierDescription],'
				SET @SQL = @SQL + ' [MinItems],'
				SET @SQL = @SQL + ' [MaxItems],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Courier]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Courier_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Courier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@CourierName" type="varchar" direction="Input" size="30" precision="0" scale="0" param="(30)" nulldefault=""/>
				<parameter name="@CourierDescription" type="varchar" direction="Input" size="60" precision="0" scale="0" param="(60)" nulldefault=""/>
				<parameter name="@MinItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaxItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Courier]
					(
					[CourierId]
					,[CourierName]
					,[CourierDescription]
					,[MinItems]
					,[MaxItems]
					)
				VALUES
					(
					@CourierId
					,@CourierName
					,@CourierDescription
					,@MinItems
					,@MaxItems
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Courier]
				WHERE
[CourierId] = @CourierId 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Courier_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Courier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalCourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@CourierName" type="varchar" direction="Input" size="30" precision="0" scale="0" param="(30)" nulldefault=""/>
				<parameter name="@CourierDescription" type="varchar" direction="Input" size="60" precision="0" scale="0" param="(60)" nulldefault=""/>
				<parameter name="@MinItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@MaxItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Courier]
				SET
					[CourierId] = @CourierId
					,[CourierName] = @CourierName
					,[CourierDescription] = @CourierDescription
					,[MinItems] = @MinItems
					,[MaxItems] = @MaxItems
				WHERE
[CourierId] = @OriginalCourierId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Courier]
				WHERE
[CourierId] = @CourierId 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Courier_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Courier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Courier] WITH (ROWLOCK) 
				WHERE
					[CourierId] = @CourierId
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Courier_GetByCourierId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Courier table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[CourierId],
					[CourierName],
					[CourierDescription],
					[MinItems],
					[MaxItems],
					[Timestamp]
				FROM
					dbo.[Courier]
				WHERE
					[CourierId] = @CourierId
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Courier_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Courier table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@CourierName" type="varchar" direction="Input" size="30" precision="0" scale="0" param="(30)" nulldefault="null"/>
				<parameter name="@CourierDescription" type="varchar" direction="Input" size="60" precision="0" scale="0" param="(60)" nulldefault="null"/>
				<parameter name="@MinItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@MaxItems" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CourierId]
	, [CourierName]
	, [CourierDescription]
	, [MinItems]
	, [MaxItems]
	, [Timestamp]
    FROM
	dbo.[Courier]
    WHERE 
	 ([CourierId] = @CourierId OR @CourierId is null)
	AND ([CourierName] = @CourierName OR @CourierName is null)
	AND ([CourierDescription] = @CourierDescription OR @CourierDescription is null)
	AND ([MinItems] = @MinItems OR @MinItems is null)
	AND ([MaxItems] = @MaxItems OR @MaxItems is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CourierId]
	, [CourierName]
	, [CourierDescription]
	, [MinItems]
	, [MaxItems]
	, [Timestamp]
    FROM
	dbo.[Courier]
    WHERE 
	 ([CourierId] = @CourierId AND @CourierId is not null)
	OR ([CourierName] = @CourierName AND @CourierName is not null)
	OR ([CourierDescription] = @CourierDescription AND @CourierDescription is not null)
	OR ([MinItems] = @MinItems AND @MinItems is not null)
	OR ([MaxItems] = @MaxItems AND @MaxItems is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="CreditCard_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the CreditCard table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Number],
					[CardType],
					[ExpiryMonth],
					[ExpiryYear],
					[Timestamp]
				FROM
					dbo.[CreditCard]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="CreditCard_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the CreditCard table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[Id]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [Id]'
				SET @SQL = @SQL + ', [Number]'
				SET @SQL = @SQL + ', [CardType]'
				SET @SQL = @SQL + ', [ExpiryMonth]'
				SET @SQL = @SQL + ', [ExpiryYear]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[CreditCard]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [Id],'
				SET @SQL = @SQL + ' [Number],'
				SET @SQL = @SQL + ' [CardType],'
				SET @SQL = @SQL + ' [ExpiryMonth],'
				SET @SQL = @SQL + ' [ExpiryYear],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[CreditCard]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="CreditCard_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the CreditCard table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Number" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CardType" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ExpiryMonth" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ExpiryYear" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[CreditCard]
					(
					[Id]
					,[Number]
					,[CardType]
					,[ExpiryMonth]
					,[ExpiryYear]
					)
				VALUES
					(
					@Id
					,@Number
					,@CardType
					,@ExpiryMonth
					,@ExpiryYear
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[CreditCard]
				WHERE
[Id] = @Id 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CreditCard_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the CreditCard table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Number" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CardType" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ExpiryMonth" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ExpiryYear" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[CreditCard]
				SET
					[Id] = @Id
					,[Number] = @Number
					,[CardType] = @CardType
					,[ExpiryMonth] = @ExpiryMonth
					,[ExpiryYear] = @ExpiryYear
				WHERE
[Id] = @OriginalId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[CreditCard]
				WHERE
[Id] = @Id 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CreditCard_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the CreditCard table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[CreditCard] WITH (ROWLOCK) 
				WHERE
					[Id] = @Id
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="CreditCard_GetById" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the CreditCard table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[Number],
					[CardType],
					[ExpiryMonth],
					[ExpiryYear],
					[Timestamp]
				FROM
					dbo.[CreditCard]
				WHERE
					[Id] = @Id
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="CreditCard_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the CreditCard table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Number" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@CardType" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@ExpiryMonth" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@ExpiryYear" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Id]
	, [Number]
	, [CardType]
	, [ExpiryMonth]
	, [ExpiryYear]
	, [Timestamp]
    FROM
	dbo.[CreditCard]
    WHERE 
	 ([Id] = @Id OR @Id is null)
	AND ([Number] = @Number OR @Number is null)
	AND ([CardType] = @CardType OR @CardType is null)
	AND ([ExpiryMonth] = @ExpiryMonth OR @ExpiryMonth is null)
	AND ([ExpiryYear] = @ExpiryYear OR @ExpiryYear is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Id]
	, [Number]
	, [CardType]
	, [ExpiryMonth]
	, [ExpiryYear]
	, [Timestamp]
    FROM
	dbo.[CreditCard]
    WHERE 
	 ([Id] = @Id AND @Id is not null)
	OR ([Number] = @Number AND @Number is not null)
	OR ([CardType] = @CardType AND @CardType is not null)
	OR ([ExpiryMonth] = @ExpiryMonth AND @ExpiryMonth is not null)
	OR ([ExpiryYear] = @ExpiryYear AND @ExpiryYear is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Inventory_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Inventory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ItemId],
					[SuppId],
					[Qty],
					[Timestamp]
				FROM
					dbo.[Inventory]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Inventory_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Inventory table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ItemId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ItemId]'
				SET @SQL = @SQL + ', [SuppId]'
				SET @SQL = @SQL + ', [Qty]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Inventory]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ItemId],'
				SET @SQL = @SQL + ' [SuppId],'
				SET @SQL = @SQL + ' [Qty],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Inventory]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Inventory_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Inventory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Qty" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Inventory]
					(
					[ItemId]
					,[SuppId]
					,[Qty]
					)
				VALUES
					(
					@ItemId
					,@SuppId
					,@Qty
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Inventory]
				WHERE
[ItemId] = @ItemId 
AND [SuppId] = @SuppId 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Inventory_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Inventory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalSuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Qty" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Inventory]
				SET
					[ItemId] = @ItemId
					,[SuppId] = @SuppId
					,[Qty] = @Qty
				WHERE
[ItemId] = @OriginalItemId 
AND [SuppId] = @OriginalSuppId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Inventory]
				WHERE
[ItemId] = @ItemId 
AND [SuppId] = @SuppId 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Inventory_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Inventory table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Inventory] WITH (ROWLOCK) 
				WHERE
					[ItemId] = @ItemId
					AND [SuppId] = @SuppId
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Inventory_GetByItemId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Inventory table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[ItemId],
					[SuppId],
					[Qty],
					[Timestamp]
				FROM
					dbo.[Inventory]
				WHERE
					[ItemId] = @ItemId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Inventory_GetBySuppId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Inventory table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[ItemId],
					[SuppId],
					[Qty],
					[Timestamp]
				FROM
					dbo.[Inventory]
				WHERE
					[SuppId] = @SuppId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Inventory_GetByItemIdSuppId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Inventory table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[ItemId],
					[SuppId],
					[Qty],
					[Timestamp]
				FROM
					dbo.[Inventory]
				WHERE
					[ItemId] = @ItemId
					AND [SuppId] = @SuppId
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Inventory_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Inventory table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Qty" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ItemId]
	, [SuppId]
	, [Qty]
	, [Timestamp]
    FROM
	dbo.[Inventory]
    WHERE 
	 ([ItemId] = @ItemId OR @ItemId is null)
	AND ([SuppId] = @SuppId OR @SuppId is null)
	AND ([Qty] = @Qty OR @Qty is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ItemId]
	, [SuppId]
	, [Qty]
	, [Timestamp]
    FROM
	dbo.[Inventory]
    WHERE 
	 ([ItemId] = @ItemId AND @ItemId is not null)
	OR ([SuppId] = @SuppId AND @SuppId is not null)
	OR ([Qty] = @Qty AND @Qty is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Item_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Item table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Name],
					[Description],
					[Price],
					[Currency],
					[Photo],
					[ProductId],
					[Timestamp]
				FROM
					dbo.[Item]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Item_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Item table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[Id]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [Id]'
				SET @SQL = @SQL + ', [Name]'
				SET @SQL = @SQL + ', [Description]'
				SET @SQL = @SQL + ', [Price]'
				SET @SQL = @SQL + ', [Currency]'
				SET @SQL = @SQL + ', [Photo]'
				SET @SQL = @SQL + ', [ProductId]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Item]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [Id],'
				SET @SQL = @SQL + ' [Name],'
				SET @SQL = @SQL + ' [Description],'
				SET @SQL = @SQL + ' [Price],'
				SET @SQL = @SQL + ' [Currency],'
				SET @SQL = @SQL + ' [Photo],'
				SET @SQL = @SQL + ' [ProductId],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Item]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Item_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Item table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Price" type="float" direction="Input" size="8" precision="53" scale="0" param="" nulldefault=""/>
				<parameter name="@Currency" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Photo" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ProductId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Item]
					(
					[Id]
					,[Name]
					,[Description]
					,[Price]
					,[Currency]
					,[Photo]
					,[ProductId]
					)
				VALUES
					(
					@Id
					,@Name
					,@Description
					,@Price
					,@Currency
					,@Photo
					,@ProductId
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Item]
				WHERE
[Id] = @Id 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Item_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Item table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Price" type="float" direction="Input" size="8" precision="53" scale="0" param="" nulldefault=""/>
				<parameter name="@Currency" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Photo" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@ProductId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Item]
				SET
					[Id] = @Id
					,[Name] = @Name
					,[Description] = @Description
					,[Price] = @Price
					,[Currency] = @Currency
					,[Photo] = @Photo
					,[ProductId] = @ProductId
				WHERE
[Id] = @OriginalId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Item]
				WHERE
[Id] = @Id 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Item_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Item table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Item] WITH (ROWLOCK) 
				WHERE
					[Id] = @Id
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Item_GetByProductId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Item table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ProductId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Name],
					[Description],
					[Price],
					[Currency],
					[Photo],
					[ProductId],
					[Timestamp]
				FROM
					dbo.[Item]
				WHERE
					[ProductId] = @ProductId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Item_GetById" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Item table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[Name],
					[Description],
					[Price],
					[Currency],
					[Photo],
					[ProductId],
					[Timestamp]
				FROM
					dbo.[Item]
				WHERE
					[Id] = @Id
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Item_GetBySuppIdFromInventory" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
SELECT dbo.[Item].[Id]
       ,dbo.[Item].[Name]
       ,dbo.[Item].[Description]
       ,dbo.[Item].[Price]
       ,dbo.[Item].[Currency]
       ,dbo.[Item].[Photo]
       ,dbo.[Item].[ProductId]
       ,dbo.[Item].[Timestamp]
  FROM dbo.[Item]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[Inventory] 
                WHERE dbo.[Inventory].[SuppId] = @SuppId
                  AND dbo.[Inventory].[ItemId] = dbo.[Item].[Id]
                  )
				Select @@ROWCOUNT			
				]]></body>
		</procedure>
		<procedure owner="dbo" name="Item_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Item table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Price" type="float" direction="Input" size="8" precision="53" scale="0" param="" nulldefault="null"/>
				<parameter name="@Currency" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Photo" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@ProductId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [Description]
	, [Price]
	, [Currency]
	, [Photo]
	, [ProductId]
	, [Timestamp]
    FROM
	dbo.[Item]
    WHERE 
	 ([Id] = @Id OR @Id is null)
	AND ([Name] = @Name OR @Name is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([Price] = @Price OR @Price is null)
	AND ([Currency] = @Currency OR @Currency is null)
	AND ([Photo] = @Photo OR @Photo is null)
	AND ([ProductId] = @ProductId OR @ProductId is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [Description]
	, [Price]
	, [Currency]
	, [Photo]
	, [ProductId]
	, [Timestamp]
    FROM
	dbo.[Item]
    WHERE 
	 ([Id] = @Id AND @Id is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([Price] = @Price AND @Price is not null)
	OR ([Currency] = @Currency AND @Currency is not null)
	OR ([Photo] = @Photo AND @Photo is not null)
	OR ([ProductId] = @ProductId AND @ProductId is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="LineItem_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the LineItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[ItemId],
					[Quantity],
					[UnitPrice],
					[Timestamp]
				FROM
					dbo.[LineItem]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="LineItem_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the LineItem table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[OrderId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [OrderId]'
				SET @SQL = @SQL + ', [LineNum]'
				SET @SQL = @SQL + ', [ItemId]'
				SET @SQL = @SQL + ', [Quantity]'
				SET @SQL = @SQL + ', [UnitPrice]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[LineItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [OrderId],'
				SET @SQL = @SQL + ' [LineNum],'
				SET @SQL = @SQL + ' [ItemId],'
				SET @SQL = @SQL + ' [Quantity],'
				SET @SQL = @SQL + ' [UnitPrice],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[LineItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="LineItem_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the LineItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Quantity" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@UnitPrice" type="money" direction="Input" size="8" precision="19" scale="4" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[LineItem]
					(
					[OrderId]
					,[LineNum]
					,[ItemId]
					,[Quantity]
					,[UnitPrice]
					)
				VALUES
					(
					@OrderId
					,@LineNum
					,@ItemId
					,@Quantity
					,@UnitPrice
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[LineItem]
				WHERE
[OrderId] = @OrderId 
AND [LineNum] = @LineNum 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="LineItem_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the LineItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalOrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalLineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Quantity" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@UnitPrice" type="money" direction="Input" size="8" precision="19" scale="4" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[LineItem]
				SET
					[OrderId] = @OrderId
					,[LineNum] = @LineNum
					,[ItemId] = @ItemId
					,[Quantity] = @Quantity
					,[UnitPrice] = @UnitPrice
				WHERE
[OrderId] = @OriginalOrderId 
AND [LineNum] = @OriginalLineNum 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[LineItem]
				WHERE
[OrderId] = @OrderId 
AND [LineNum] = @LineNum 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="LineItem_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the LineItem table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[LineItem] WITH (ROWLOCK) 
				WHERE
					[OrderId] = @OrderId
					AND [LineNum] = @LineNum
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="LineItem_GetByOrderId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the LineItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[ItemId],
					[Quantity],
					[UnitPrice],
					[Timestamp]
				FROM
					dbo.[LineItem]
				WHERE
					[OrderId] = @OrderId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="LineItem_GetByItemId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the LineItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[ItemId],
					[Quantity],
					[UnitPrice],
					[Timestamp]
				FROM
					dbo.[LineItem]
				WHERE
					[ItemId] = @ItemId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="LineItem_GetByLineNumOrderId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the LineItem table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[OrderId],
					[LineNum],
					[ItemId],
					[Quantity],
					[UnitPrice],
					[Timestamp]
				FROM
					dbo.[LineItem]
				WHERE
					[OrderId] = @OrderId
					AND [LineNum] = @LineNum
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="LineItem_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the LineItem table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Quantity" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@UnitPrice" type="money" direction="Input" size="8" precision="19" scale="4" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [OrderId]
	, [LineNum]
	, [ItemId]
	, [Quantity]
	, [UnitPrice]
	, [Timestamp]
    FROM
	dbo.[LineItem]
    WHERE 
	 ([OrderId] = @OrderId OR @OrderId is null)
	AND ([LineNum] = @LineNum OR @LineNum is null)
	AND ([ItemId] = @ItemId OR @ItemId is null)
	AND ([Quantity] = @Quantity OR @Quantity is null)
	AND ([UnitPrice] = @UnitPrice OR @UnitPrice is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [OrderId]
	, [LineNum]
	, [ItemId]
	, [Quantity]
	, [UnitPrice]
	, [Timestamp]
    FROM
	dbo.[LineItem]
    WHERE 
	 ([OrderId] = @OrderId AND @OrderId is not null)
	OR ([LineNum] = @LineNum AND @LineNum is not null)
	OR ([ItemId] = @ItemId AND @ItemId is not null)
	OR ([Quantity] = @Quantity AND @Quantity is not null)
	OR ([UnitPrice] = @UnitPrice AND @UnitPrice is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Orders_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Orders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[AccountId],
					[OrderDate],
					[ShipAddr1],
					[ShipAddr2],
					[ShipCity],
					[ShipState],
					[ShipZip],
					[ShipCountry],
					[BillAddr1],
					[BillAddr2],
					[BillCity],
					[BillState],
					[BillZip],
					[BillCountry],
					[CourierId],
					[TotalPrice],
					[BillToFirstName],
					[BillToLastName],
					[ShipToFirstName],
					[ShipToLastName],
					[CreditCardId],
					[Locale],
					[Timestamp]
				FROM
					dbo.[Orders]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Orders_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Orders table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[OrderId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [OrderId]'
				SET @SQL = @SQL + ', [AccountId]'
				SET @SQL = @SQL + ', [OrderDate]'
				SET @SQL = @SQL + ', [ShipAddr1]'
				SET @SQL = @SQL + ', [ShipAddr2]'
				SET @SQL = @SQL + ', [ShipCity]'
				SET @SQL = @SQL + ', [ShipState]'
				SET @SQL = @SQL + ', [ShipZip]'
				SET @SQL = @SQL + ', [ShipCountry]'
				SET @SQL = @SQL + ', [BillAddr1]'
				SET @SQL = @SQL + ', [BillAddr2]'
				SET @SQL = @SQL + ', [BillCity]'
				SET @SQL = @SQL + ', [BillState]'
				SET @SQL = @SQL + ', [BillZip]'
				SET @SQL = @SQL + ', [BillCountry]'
				SET @SQL = @SQL + ', [CourierId]'
				SET @SQL = @SQL + ', [TotalPrice]'
				SET @SQL = @SQL + ', [BillToFirstName]'
				SET @SQL = @SQL + ', [BillToLastName]'
				SET @SQL = @SQL + ', [ShipToFirstName]'
				SET @SQL = @SQL + ', [ShipToLastName]'
				SET @SQL = @SQL + ', [CreditCardId]'
				SET @SQL = @SQL + ', [Locale]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Orders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [OrderId],'
				SET @SQL = @SQL + ' [AccountId],'
				SET @SQL = @SQL + ' [OrderDate],'
				SET @SQL = @SQL + ' [ShipAddr1],'
				SET @SQL = @SQL + ' [ShipAddr2],'
				SET @SQL = @SQL + ' [ShipCity],'
				SET @SQL = @SQL + ' [ShipState],'
				SET @SQL = @SQL + ' [ShipZip],'
				SET @SQL = @SQL + ' [ShipCountry],'
				SET @SQL = @SQL + ' [BillAddr1],'
				SET @SQL = @SQL + ' [BillAddr2],'
				SET @SQL = @SQL + ' [BillCity],'
				SET @SQL = @SQL + ' [BillState],'
				SET @SQL = @SQL + ' [BillZip],'
				SET @SQL = @SQL + ' [BillCountry],'
				SET @SQL = @SQL + ' [CourierId],'
				SET @SQL = @SQL + ' [TotalPrice],'
				SET @SQL = @SQL + ' [BillToFirstName],'
				SET @SQL = @SQL + ' [BillToLastName],'
				SET @SQL = @SQL + ' [ShipToFirstName],'
				SET @SQL = @SQL + ' [ShipToLastName],'
				SET @SQL = @SQL + ' [CreditCardId],'
				SET @SQL = @SQL + ' [Locale],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Orders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Orders_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Orders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@AccountId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ShipAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@ShipCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BillAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BillCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@TotalPrice" type="decimal" direction="Input" size="9" precision="10" scale="2" param="(10, 2)" nulldefault=""/>
				<parameter name="@BillToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Locale" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Orders]
					(
					[AccountId]
					,[OrderDate]
					,[ShipAddr1]
					,[ShipAddr2]
					,[ShipCity]
					,[ShipState]
					,[ShipZip]
					,[ShipCountry]
					,[BillAddr1]
					,[BillAddr2]
					,[BillCity]
					,[BillState]
					,[BillZip]
					,[BillCountry]
					,[CourierId]
					,[TotalPrice]
					,[BillToFirstName]
					,[BillToLastName]
					,[ShipToFirstName]
					,[ShipToLastName]
					,[CreditCardId]
					,[Locale]
					)
				VALUES
					(
					@AccountId
					,@OrderDate
					,@ShipAddr1
					,@ShipAddr2
					,@ShipCity
					,@ShipState
					,@ShipZip
					,@ShipCountry
					,@BillAddr1
					,@BillAddr2
					,@BillCity
					,@BillState
					,@BillZip
					,@BillCountry
					,@CourierId
					,@TotalPrice
					,@BillToFirstName
					,@BillToLastName
					,@ShipToFirstName
					,@ShipToLastName
					,@CreditCardId
					,@Locale
					)
				
				-- Get the identity value
				SET @OrderId = SCOPE_IDENTITY()
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Orders]
				WHERE
[OrderId] = @OrderId 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Orders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@AccountId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@ShipAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@ShipCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BillAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@BillCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@TotalPrice" type="decimal" direction="Input" size="9" precision="10" scale="2" param="(10, 2)" nulldefault=""/>
				<parameter name="@BillToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@BillToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@ShipToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Locale" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Orders]
				SET
					[AccountId] = @AccountId
					,[OrderDate] = @OrderDate
					,[ShipAddr1] = @ShipAddr1
					,[ShipAddr2] = @ShipAddr2
					,[ShipCity] = @ShipCity
					,[ShipState] = @ShipState
					,[ShipZip] = @ShipZip
					,[ShipCountry] = @ShipCountry
					,[BillAddr1] = @BillAddr1
					,[BillAddr2] = @BillAddr2
					,[BillCity] = @BillCity
					,[BillState] = @BillState
					,[BillZip] = @BillZip
					,[BillCountry] = @BillCountry
					,[CourierId] = @CourierId
					,[TotalPrice] = @TotalPrice
					,[BillToFirstName] = @BillToFirstName
					,[BillToLastName] = @BillToLastName
					,[ShipToFirstName] = @ShipToFirstName
					,[ShipToLastName] = @ShipToLastName
					,[CreditCardId] = @CreditCardId
					,[Locale] = @Locale
				WHERE
[OrderId] = @OrderId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Orders]
				WHERE
[OrderId] = @OrderId 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Orders table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Orders] WITH (ROWLOCK) 
				WHERE
					[OrderId] = @OrderId
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_GetByAccountId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Orders table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@AccountId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[AccountId],
					[OrderDate],
					[ShipAddr1],
					[ShipAddr2],
					[ShipCity],
					[ShipState],
					[ShipZip],
					[ShipCountry],
					[BillAddr1],
					[BillAddr2],
					[BillCity],
					[BillState],
					[BillZip],
					[BillCountry],
					[CourierId],
					[TotalPrice],
					[BillToFirstName],
					[BillToLastName],
					[ShipToFirstName],
					[ShipToLastName],
					[CreditCardId],
					[Locale],
					[Timestamp]
				FROM
					dbo.[Orders]
				WHERE
					[AccountId] = @AccountId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_GetByCourierId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Orders table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[AccountId],
					[OrderDate],
					[ShipAddr1],
					[ShipAddr2],
					[ShipCity],
					[ShipState],
					[ShipZip],
					[ShipCountry],
					[BillAddr1],
					[BillAddr2],
					[BillCity],
					[BillState],
					[BillZip],
					[BillCountry],
					[CourierId],
					[TotalPrice],
					[BillToFirstName],
					[BillToLastName],
					[ShipToFirstName],
					[ShipToLastName],
					[CreditCardId],
					[Locale],
					[Timestamp]
				FROM
					dbo.[Orders]
				WHERE
					[CourierId] = @CourierId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_GetByCreditCardId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Orders table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[AccountId],
					[OrderDate],
					[ShipAddr1],
					[ShipAddr2],
					[ShipCity],
					[ShipState],
					[ShipZip],
					[ShipCountry],
					[BillAddr1],
					[BillAddr2],
					[BillCity],
					[BillState],
					[BillZip],
					[BillCountry],
					[CourierId],
					[TotalPrice],
					[BillToFirstName],
					[BillToLastName],
					[ShipToFirstName],
					[ShipToLastName],
					[CreditCardId],
					[Locale],
					[Timestamp]
				FROM
					dbo.[Orders]
				WHERE
					[CreditCardId] = @CreditCardId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Orders_GetByOrderId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Orders table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[OrderId],
					[AccountId],
					[OrderDate],
					[ShipAddr1],
					[ShipAddr2],
					[ShipCity],
					[ShipState],
					[ShipZip],
					[ShipCountry],
					[BillAddr1],
					[BillAddr2],
					[BillCity],
					[BillState],
					[BillZip],
					[BillCountry],
					[CourierId],
					[TotalPrice],
					[BillToFirstName],
					[BillToLastName],
					[ShipToFirstName],
					[ShipToLastName],
					[CreditCardId],
					[Locale],
					[Timestamp]
				FROM
					dbo.[Orders]
				WHERE
					[OrderId] = @OrderId
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Orders_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Orders table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@AccountId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@ShipAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@ShipCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@BillAddr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@BillAddr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@BillCity" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@BillState" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@BillZip" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@BillCountry" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@CourierId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@TotalPrice" type="decimal" direction="Input" size="9" precision="10" scale="2" param="(10, 2)" nulldefault="null"/>
				<parameter name="@BillToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@BillToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipToFirstName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@ShipToLastName" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@CreditCardId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Locale" type="varchar" direction="Input" size="20" precision="0" scale="0" param="(20)" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [OrderId]
	, [AccountId]
	, [OrderDate]
	, [ShipAddr1]
	, [ShipAddr2]
	, [ShipCity]
	, [ShipState]
	, [ShipZip]
	, [ShipCountry]
	, [BillAddr1]
	, [BillAddr2]
	, [BillCity]
	, [BillState]
	, [BillZip]
	, [BillCountry]
	, [CourierId]
	, [TotalPrice]
	, [BillToFirstName]
	, [BillToLastName]
	, [ShipToFirstName]
	, [ShipToLastName]
	, [CreditCardId]
	, [Locale]
	, [Timestamp]
    FROM
	dbo.[Orders]
    WHERE 
	 ([OrderId] = @OrderId OR @OrderId is null)
	AND ([AccountId] = @AccountId OR @AccountId is null)
	AND ([OrderDate] = @OrderDate OR @OrderDate is null)
	AND ([ShipAddr1] = @ShipAddr1 OR @ShipAddr1 is null)
	AND ([ShipAddr2] = @ShipAddr2 OR @ShipAddr2 is null)
	AND ([ShipCity] = @ShipCity OR @ShipCity is null)
	AND ([ShipState] = @ShipState OR @ShipState is null)
	AND ([ShipZip] = @ShipZip OR @ShipZip is null)
	AND ([ShipCountry] = @ShipCountry OR @ShipCountry is null)
	AND ([BillAddr1] = @BillAddr1 OR @BillAddr1 is null)
	AND ([BillAddr2] = @BillAddr2 OR @BillAddr2 is null)
	AND ([BillCity] = @BillCity OR @BillCity is null)
	AND ([BillState] = @BillState OR @BillState is null)
	AND ([BillZip] = @BillZip OR @BillZip is null)
	AND ([BillCountry] = @BillCountry OR @BillCountry is null)
	AND ([CourierId] = @CourierId OR @CourierId is null)
	AND ([TotalPrice] = @TotalPrice OR @TotalPrice is null)
	AND ([BillToFirstName] = @BillToFirstName OR @BillToFirstName is null)
	AND ([BillToLastName] = @BillToLastName OR @BillToLastName is null)
	AND ([ShipToFirstName] = @ShipToFirstName OR @ShipToFirstName is null)
	AND ([ShipToLastName] = @ShipToLastName OR @ShipToLastName is null)
	AND ([CreditCardId] = @CreditCardId OR @CreditCardId is null)
	AND ([Locale] = @Locale OR @Locale is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [OrderId]
	, [AccountId]
	, [OrderDate]
	, [ShipAddr1]
	, [ShipAddr2]
	, [ShipCity]
	, [ShipState]
	, [ShipZip]
	, [ShipCountry]
	, [BillAddr1]
	, [BillAddr2]
	, [BillCity]
	, [BillState]
	, [BillZip]
	, [BillCountry]
	, [CourierId]
	, [TotalPrice]
	, [BillToFirstName]
	, [BillToLastName]
	, [ShipToFirstName]
	, [ShipToLastName]
	, [CreditCardId]
	, [Locale]
	, [Timestamp]
    FROM
	dbo.[Orders]
    WHERE 
	 ([OrderId] = @OrderId AND @OrderId is not null)
	OR ([AccountId] = @AccountId AND @AccountId is not null)
	OR ([OrderDate] = @OrderDate AND @OrderDate is not null)
	OR ([ShipAddr1] = @ShipAddr1 AND @ShipAddr1 is not null)
	OR ([ShipAddr2] = @ShipAddr2 AND @ShipAddr2 is not null)
	OR ([ShipCity] = @ShipCity AND @ShipCity is not null)
	OR ([ShipState] = @ShipState AND @ShipState is not null)
	OR ([ShipZip] = @ShipZip AND @ShipZip is not null)
	OR ([ShipCountry] = @ShipCountry AND @ShipCountry is not null)
	OR ([BillAddr1] = @BillAddr1 AND @BillAddr1 is not null)
	OR ([BillAddr2] = @BillAddr2 AND @BillAddr2 is not null)
	OR ([BillCity] = @BillCity AND @BillCity is not null)
	OR ([BillState] = @BillState AND @BillState is not null)
	OR ([BillZip] = @BillZip AND @BillZip is not null)
	OR ([BillCountry] = @BillCountry AND @BillCountry is not null)
	OR ([CourierId] = @CourierId AND @CourierId is not null)
	OR ([TotalPrice] = @TotalPrice AND @TotalPrice is not null)
	OR ([BillToFirstName] = @BillToFirstName AND @BillToFirstName is not null)
	OR ([BillToLastName] = @BillToLastName AND @BillToLastName is not null)
	OR ([ShipToFirstName] = @ShipToFirstName AND @ShipToFirstName is not null)
	OR ([ShipToLastName] = @ShipToLastName AND @ShipToLastName is not null)
	OR ([CreditCardId] = @CreditCardId AND @CreditCardId is not null)
	OR ([Locale] = @Locale AND @Locale is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="OrderStatus_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the OrderStatus table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[OrderDate],
					[OrderStatusId],
					[Timestamp]
				FROM
					dbo.[OrderStatus]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="OrderStatus_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the OrderStatus table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[OrderId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [OrderId]'
				SET @SQL = @SQL + ', [LineNum]'
				SET @SQL = @SQL + ', [OrderDate]'
				SET @SQL = @SQL + ', [OrderStatusId]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[OrderStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [OrderId],'
				SET @SQL = @SQL + ' [LineNum],'
				SET @SQL = @SQL + ' [OrderDate],'
				SET @SQL = @SQL + ' [OrderStatusId],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[OrderStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="OrderStatus_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the OrderStatus table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[OrderStatus]
					(
					[OrderId]
					,[LineNum]
					,[OrderDate]
					,[OrderStatusId]
					)
				VALUES
					(
					@OrderId
					,@LineNum
					,@OrderDate
					,@OrderStatusId
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[OrderStatus]
				WHERE
[OrderId] = @OrderId 
AND [LineNum] = @LineNum 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatus_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the OrderStatus table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalOrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalLineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault=""/>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[OrderStatus]
				SET
					[OrderId] = @OrderId
					,[LineNum] = @LineNum
					,[OrderDate] = @OrderDate
					,[OrderStatusId] = @OrderStatusId
				WHERE
[OrderId] = @OriginalOrderId 
AND [LineNum] = @OriginalLineNum 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[OrderStatus]
				WHERE
[OrderId] = @OrderId 
AND [LineNum] = @LineNum 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatus_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the OrderStatus table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[OrderStatus] WITH (ROWLOCK) 
				WHERE
					[OrderId] = @OrderId
					AND [LineNum] = @LineNum
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatus_GetByOrderId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the OrderStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[OrderDate],
					[OrderStatusId],
					[Timestamp]
				FROM
					dbo.[OrderStatus]
				WHERE
					[OrderId] = @OrderId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatus_GetByOrderStatusId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the OrderStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[OrderId],
					[LineNum],
					[OrderDate],
					[OrderStatusId],
					[Timestamp]
				FROM
					dbo.[OrderStatus]
				WHERE
					[OrderStatusId] = @OrderStatusId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatus_GetByLineNumOrderId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the OrderStatus table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[OrderId],
					[LineNum],
					[OrderDate],
					[OrderStatusId],
					[Timestamp]
				FROM
					dbo.[OrderStatus]
				WHERE
					[OrderId] = @OrderId
					AND [LineNum] = @LineNum
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="OrderStatus_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the OrderStatus table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@LineNum" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderDate" type="datetime" direction="Input" size="8" precision="23" scale="3" param="" nulldefault="null"/>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [OrderId]
	, [LineNum]
	, [OrderDate]
	, [OrderStatusId]
	, [Timestamp]
    FROM
	dbo.[OrderStatus]
    WHERE 
	 ([OrderId] = @OrderId OR @OrderId is null)
	AND ([LineNum] = @LineNum OR @LineNum is null)
	AND ([OrderDate] = @OrderDate OR @OrderDate is null)
	AND ([OrderStatusId] = @OrderStatusId OR @OrderStatusId is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [OrderId]
	, [LineNum]
	, [OrderDate]
	, [OrderStatusId]
	, [Timestamp]
    FROM
	dbo.[OrderStatus]
    WHERE 
	 ([OrderId] = @OrderId AND @OrderId is not null)
	OR ([LineNum] = @LineNum AND @LineNum is not null)
	OR ([OrderDate] = @OrderDate AND @OrderDate is not null)
	OR ([OrderStatusId] = @OrderStatusId AND @OrderStatusId is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="OrderStatusType_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the OrderStatusType table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[OrderStatusId],
					[OrderStatus],
					[OrderStatusDescription]
				FROM
					dbo.[OrderStatusType]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="OrderStatusType_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the OrderStatusType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[OrderStatusId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [OrderStatusId]'
				SET @SQL = @SQL + ', [OrderStatus]'
				SET @SQL = @SQL + ', [OrderStatusDescription]'
				SET @SQL = @SQL + ' FROM dbo.[OrderStatusType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [OrderStatusId],'
				SET @SQL = @SQL + ' [OrderStatus],'
				SET @SQL = @SQL + ' [OrderStatusDescription]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[OrderStatusType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="OrderStatusType_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the OrderStatusType table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatusId" type="int" direction="Output" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderStatus" type="varchar" direction="Input" size="24" precision="0" scale="0" param="(24)" nulldefault=""/>
				<parameter name="@OrderStatusDescription" type="varchar" direction="Input" size="300" precision="0" scale="0" param="(300)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[OrderStatusType]
					(
					[OrderStatus]
					,[OrderStatusDescription]
					)
				VALUES
					(
					@OrderStatus
					,@OrderStatusDescription
					)
				
				-- Get the identity value
				SET @OrderStatusId = SCOPE_IDENTITY()
									
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatusType_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the OrderStatusType table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
				<parameter name="@OrderStatus" type="varchar" direction="Input" size="24" precision="0" scale="0" param="(24)" nulldefault=""/>
				<parameter name="@OrderStatusDescription" type="varchar" direction="Input" size="300" precision="0" scale="0" param="(300)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[OrderStatusType]
				SET
					[OrderStatus] = @OrderStatus
					,[OrderStatusDescription] = @OrderStatusDescription
				WHERE
[OrderStatusId] = @OrderStatusId 
				
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatusType_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the OrderStatusType table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[OrderStatusType] WITH (ROWLOCK) 
				WHERE
					[OrderStatusId] = @OrderStatusId
					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="OrderStatusType_GetByOrderStatusId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the OrderStatusType table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[OrderStatusId],
					[OrderStatus],
					[OrderStatusDescription]
				FROM
					dbo.[OrderStatusType]
				WHERE
					[OrderStatusId] = @OrderStatusId
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="OrderStatusType_GetByOrderStatus" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the OrderStatusType table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@OrderStatus" type="varchar" direction="Input" size="24" precision="0" scale="0" param="(24)" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[OrderStatusId],
					[OrderStatus],
					[OrderStatusDescription]
				FROM
					dbo.[OrderStatusType]
				WHERE
					[OrderStatus] = @OrderStatus
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="OrderStatusType_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the OrderStatusType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderStatusId" type="int" direction="Input" size="4" precision="10" scale="0" param="" nulldefault="null"/>
				<parameter name="@OrderStatus" type="varchar" direction="Input" size="24" precision="0" scale="0" param="(24)" nulldefault="null"/>
				<parameter name="@OrderStatusDescription" type="varchar" direction="Input" size="300" precision="0" scale="0" param="(300)" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [OrderStatusId]
	, [OrderStatus]
	, [OrderStatusDescription]
    FROM
	dbo.[OrderStatusType]
    WHERE 
	 ([OrderStatusId] = @OrderStatusId OR @OrderStatusId is null)
	AND ([OrderStatus] = @OrderStatus OR @OrderStatus is null)
	AND ([OrderStatusDescription] = @OrderStatusDescription OR @OrderStatusDescription is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [OrderStatusId]
	, [OrderStatus]
	, [OrderStatusDescription]
    FROM
	dbo.[OrderStatusType]
    WHERE 
	 ([OrderStatusId] = @OrderStatusId AND @OrderStatusId is not null)
	OR ([OrderStatus] = @OrderStatus AND @OrderStatus is not null)
	OR ([OrderStatusDescription] = @OrderStatusDescription AND @OrderStatusDescription is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Product_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Product table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Name],
					[Description],
					[CategoryId],
					[Timestamp]
				FROM
					dbo.[Product]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Product_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Product table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[Id]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [Id]'
				SET @SQL = @SQL + ', [Name]'
				SET @SQL = @SQL + ', [Description]'
				SET @SQL = @SQL + ', [CategoryId]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Product]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [Id],'
				SET @SQL = @SQL + ' [Name],'
				SET @SQL = @SQL + ' [Description],'
				SET @SQL = @SQL + ' [CategoryId],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Product]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Product_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Product table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Product]
					(
					[Id]
					,[Name]
					,[Description]
					,[CategoryId]
					)
				VALUES
					(
					@Id
					,@Name
					,@Description
					,@CategoryId
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Product]
				WHERE
[Id] = @Id 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Product_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Product table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault=""/>
				<parameter name="@CategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Product]
				SET
					[Id] = @Id
					,[Name] = @Name
					,[Description] = @Description
					,[CategoryId] = @CategoryId
				WHERE
[Id] = @OriginalId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Product]
				WHERE
[Id] = @Id 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Product_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Product table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Product] WITH (ROWLOCK) 
				WHERE
					[Id] = @Id
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Product_GetByCategoryId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Product table through a foreign key
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@CategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				SELECT
					[Id],
					[Name],
					[Description],
					[CategoryId],
					[Timestamp]
				FROM
					dbo.[Product]
				WHERE
					[CategoryId] = @CategoryId
				
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Product_GetById" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Product table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[Id],
					[Name],
					[Description],
					[CategoryId],
					[Timestamp]
				FROM
					dbo.[Product]
				WHERE
					[Id] = @Id
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Product_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Product table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@Id" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@Description" type="varchar" direction="Input" size="255" precision="0" scale="0" param="(255)" nulldefault="null"/>
				<parameter name="@CategoryId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [Description]
	, [CategoryId]
	, [Timestamp]
    FROM
	dbo.[Product]
    WHERE 
	 ([Id] = @Id OR @Id is null)
	AND ([Name] = @Name OR @Name is null)
	AND ([Description] = @Description OR @Description is null)
	AND ([CategoryId] = @CategoryId OR @CategoryId is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [Id]
	, [Name]
	, [Description]
	, [CategoryId]
	, [Timestamp]
    FROM
	dbo.[Product]
    WHERE 
	 ([Id] = @Id AND @Id is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([CategoryId] = @CategoryId AND @CategoryId is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Supplier_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the Supplier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[SuppId],
					[Name],
					[Status],
					[Addr1],
					[Addr2],
					[City],
					[State],
					[Zip],
					[Phone],
					[Timestamp]
				FROM
					dbo.[Supplier]
					
				Select @@ROWCOUNT
			]]></body>
		</procedure>
		
		
		<procedure owner="dbo" name="Supplier_GetPaged" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the Supplier table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[SuppId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [SuppId]'
				SET @SQL = @SQL + ', [Name]'
				SET @SQL = @SQL + ', [Status]'
				SET @SQL = @SQL + ', [Addr1]'
				SET @SQL = @SQL + ', [Addr2]'
				SET @SQL = @SQL + ', [City]'
				SET @SQL = @SQL + ', [State]'
				SET @SQL = @SQL + ', [Zip]'
				SET @SQL = @SQL + ', [Phone]'
				SET @SQL = @SQL + ', [Timestamp]'
				SET @SQL = @SQL + ' FROM dbo.[Supplier]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [SuppId],'
				SET @SQL = @SQL + ' [Name],'
				SET @SQL = @SQL + ' [Status],'
				SET @SQL = @SQL + ' [Addr1],'
				SET @SQL = @SQL + ' [Addr2],'
				SET @SQL = @SQL + ' [City],'
				SET @SQL = @SQL + ' [State],'
				SET @SQL = @SQL + ' [Zip],'
				SET @SQL = @SQL + ' [Phone],'
				SET @SQL = @SQL + ' [Timestamp]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[Supplier]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
			
				END
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="Supplier_Insert" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Inserts a record into the Supplier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="2" precision="0" scale="0" param="(2)" nulldefault=""/>
				<parameter name="@Addr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Addr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@State" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Zip" type="varchar" direction="Input" size="5" precision="0" scale="0" param="(5)" nulldefault=""/>
				<parameter name="@Phone" type="varchar" direction="Input" size="40" precision="0" scale="0" param="(40)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
					
				INSERT INTO dbo.[Supplier]
					(
					[SuppId]
					,[Name]
					,[Status]
					,[Addr1]
					,[Addr2]
					,[City]
					,[State]
					,[Zip]
					,[Phone]
					)
				VALUES
					(
					@SuppId
					,@Name
					,@Status
					,@Addr1
					,@Addr2
					,@City
					,@State
					,@Zip
					,@Phone
					)
				
									
				-- Select computed columns into output parameters
				SELECT
 @Timestamp = [Timestamp]
				FROM
					dbo.[Supplier]
				WHERE
[SuppId] = @SuppId 
							
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Supplier_Update" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Updates a record in the Supplier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@OriginalSuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Name" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Status" type="varchar" direction="Input" size="2" precision="0" scale="0" param="(2)" nulldefault=""/>
				<parameter name="@Addr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Addr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@City" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@State" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault=""/>
				<parameter name="@Zip" type="varchar" direction="Input" size="5" precision="0" scale="0" param="(5)" nulldefault=""/>
				<parameter name="@Phone" type="varchar" direction="Input" size="40" precision="0" scale="0" param="(40)" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@ReturnedTimestamp" type="timestamp" direction="Output" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				
				
				-- Modify the updatable columns
				UPDATE
					dbo.[Supplier]
				SET
					[SuppId] = @SuppId
					,[Name] = @Name
					,[Status] = @Status
					,[Addr1] = @Addr1
					,[Addr2] = @Addr2
					,[City] = @City
					,[State] = @State
					,[Zip] = @Zip
					,[Phone] = @Phone
				WHERE
[SuppId] = @OriginalSuppId 
AND [Timestamp] = @Timestamp				
				
				-- Select computed columns into output parameters
				SELECT
 @ReturnedTimestamp = [Timestamp]
				FROM
					dbo.[Supplier]
				WHERE
[SuppId] = @SuppId 
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Supplier_Delete" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Deletes a record in the Supplier table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				DELETE FROM dbo.[Supplier] WITH (ROWLOCK) 
				WHERE
					[SuppId] = @SuppId
	AND [Timestamp] = @Timestamp					
			]]></body>
		</procedure>
		<procedure owner="dbo" name="Supplier_GetBySuppId" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Select records from the Supplier table through an index
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
				SELECT
					[SuppId],
					[Name],
					[Status],
					[Addr1],
					[Addr2],
					[City],
					[State],
					[Zip],
					[Phone],
					[Timestamp]
				FROM
					dbo.[Supplier]
				WHERE
					[SuppId] = @SuppId
			Select @@ROWCOUNT
					
			]]></body>
			
		</procedure>
		<procedure owner="dbo" name="Supplier_GetByItemIdFromInventory" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@ItemId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault=""/>
			</parameters>
			<body><![CDATA[
SELECT dbo.[Supplier].[SuppId]
       ,dbo.[Supplier].[Name]
       ,dbo.[Supplier].[Status]
       ,dbo.[Supplier].[Addr1]
       ,dbo.[Supplier].[Addr2]
       ,dbo.[Supplier].[City]
       ,dbo.[Supplier].[State]
       ,dbo.[Supplier].[Zip]
       ,dbo.[Supplier].[Phone]
       ,dbo.[Supplier].[Timestamp]
  FROM dbo.[Supplier]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[Inventory] 
                WHERE dbo.[Inventory].[ItemId] = @ItemId
                  AND dbo.[Inventory].[SuppId] = dbo.[Supplier].[SuppId]
                  )
				Select @@ROWCOUNT			
				]]></body>
		</procedure>
		<procedure owner="dbo" name="Supplier_Find" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Finds records in the Supplier table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@SearchUsingOR" type="bit" direction="Input" size="0" precision="1" scale="0" param="" nulldefault="null"/>
				<parameter name="@SuppId" type="uniqueidentifier" direction="Input" size="16" precision="0" scale="0" param="" nulldefault="null"/>
				<parameter name="@Name" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@Status" type="varchar" direction="Input" size="2" precision="0" scale="0" param="(2)" nulldefault="null"/>
				<parameter name="@Addr1" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@Addr2" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@City" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@State" type="varchar" direction="Input" size="80" precision="0" scale="0" param="(80)" nulldefault="null"/>
				<parameter name="@Zip" type="varchar" direction="Input" size="5" precision="0" scale="0" param="(5)" nulldefault="null"/>
				<parameter name="@Phone" type="varchar" direction="Input" size="40" precision="0" scale="0" param="(40)" nulldefault="null"/>
				<parameter name="@Timestamp" type="timestamp" direction="Input" size="8" precision="0" scale="0" param="" nulldefault="null"/>
			</parameters>
			<body><![CDATA[
				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SuppId]
	, [Name]
	, [Status]
	, [Addr1]
	, [Addr2]
	, [City]
	, [State]
	, [Zip]
	, [Phone]
	, [Timestamp]
    FROM
	dbo.[Supplier]
    WHERE 
	 ([SuppId] = @SuppId OR @SuppId is null)
	AND ([Name] = @Name OR @Name is null)
	AND ([Status] = @Status OR @Status is null)
	AND ([Addr1] = @Addr1 OR @Addr1 is null)
	AND ([Addr2] = @Addr2 OR @Addr2 is null)
	AND ([City] = @City OR @City is null)
	AND ([State] = @State OR @State is null)
	AND ([Zip] = @Zip OR @Zip is null)
	AND ([Phone] = @Phone OR @Phone is null)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SuppId]
	, [Name]
	, [Status]
	, [Addr1]
	, [Addr2]
	, [City]
	, [State]
	, [Zip]
	, [Phone]
	, [Timestamp]
    FROM
	dbo.[Supplier]
    WHERE 
	 ([SuppId] = @SuppId AND @SuppId is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([Addr1] = @Addr1 AND @Addr1 is not null)
	OR ([Addr2] = @Addr2 AND @Addr2 is not null)
	OR ([City] = @City AND @City is not null)
	OR ([State] = @State AND @State is not null)
	OR ([Zip] = @Zip AND @Zip is not null)
	OR ([Phone] = @Phone AND @Phone is not null)
	Select @@ROWCOUNT			
  END
				]]></body>
		</procedure>
		<procedure owner="dbo" name="ExtendedItem_Get_List" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets all records from the ExtendedItem view
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters/>
			<body><![CDATA[
				
				SELECT
					[ItemId],
					[ItemName],
					[ItemDescription],
					[ItemPrice],
					[ItemPhoto],
					[ProductId],
					[ProductName],
					[ProductDescription],
					[CategoryId],
					[CategoryName]
				FROM
					dbo.[ExtendedItem]
					
				Select @@ROWCOUNT			
			]]></body>
		</procedure>
		
		<procedure owner="dbo" name="ExtendedItem_Get" grant="">
			<comment><![CDATA[/*
----------------------------------------------------------------------------------------------------
-- Date Created: Monday, July 24, 2006

-- Created By: NetTiers (www.nettiers.com)
-- Purpose: Gets records from the ExtendedItem view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/
]]></comment>
			<parameters>
				<parameter name="@WhereClause" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)" />
				<parameter name="@OrderBy" type="varchar" direction="Input" size="2000" precision="0" scale="0" param="(2000)"/>			
				<parameter name="@PageIndex" type="int" direction="Input" size="0" precision="10" scale="0" />
				<parameter name="@PageSize" type="int" direction="Input" size="0" precision="10" scale="0" /> 
			</parameters>
			<body><![CDATA[
				
				BEGIN

				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				IF (@OrderBy is null or LEN(@OrderBy) < 1)
				BEGIN
					-- default order by to first column
					SET @OrderBy = '[ItemId]'
				END

				-- SQL Server 2005 Paging
				declare @SQL as nvarchar(4000)
				SET @SQL = 'WITH PageIndex AS ('
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + convert(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' ROW_NUMBER() OVER (ORDER BY ' + @OrderBy + ') as RowIndex'
				SET @SQL = @SQL + ', [ItemId]'
				SET @SQL = @SQL + ', [ItemName]'
				SET @SQL = @SQL + ', [ItemDescription]'
				SET @SQL = @SQL + ', [ItemPrice]'
				SET @SQL = @SQL + ', [ItemPhoto]'
				SET @SQL = @SQL + ', [ProductId]'
				SET @SQL = @SQL + ', [ProductName]'
				SET @SQL = @SQL + ', [ProductDescription]'
				SET @SQL = @SQL + ', [CategoryId]'
				SET @SQL = @SQL + ', [CategoryName]'
				SET @SQL = @SQL + ' FROM dbo.[ExtendedItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				SET @SQL = @SQL + ' ) SELECT'
				SET @SQL = @SQL + ' [ItemId],'
				SET @SQL = @SQL + ' [ItemName],'
				SET @SQL = @SQL + ' [ItemDescription],'
				SET @SQL = @SQL + ' [ItemPrice],'
				SET @SQL = @SQL + ' [ItemPhoto],'
				SET @SQL = @SQL + ' [ProductId],'
				SET @SQL = @SQL + ' [ProductName],'
				SET @SQL = @SQL + ' [ProductDescription],'
				SET @SQL = @SQL + ' [CategoryId],'
				SET @SQL = @SQL + ' [CategoryName]'
				SET @SQL = @SQL + ' FROM PageIndex'
				SET @SQL = @SQL + ' WHERE RowIndex > ' + convert(nvarchar, @PageLowerBound)
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' AND RowIndex <= ' + convert(nvarchar, @PageUpperBound)
				END
				exec sp_executesql @SQL

				-- get row count
				SET @SQL = 'SELECT COUNT(*) as TotalRowCount'
				SET @SQL = @SQL + ' FROM dbo.[ExtendedItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				exec sp_executesql @SQL
				
				END
			]]></body>
		</procedure>
		
</procedures>
</root>
